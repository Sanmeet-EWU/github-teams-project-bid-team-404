---
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import BaseHead from '../components/BaseHead.astro';
import "../styles/auth.css";
---

<html lang="en">
<BaseHead />
<body>
  <Header />
  <main class="auth-main">
    <h1>Sign In</h1>
    <div class="auth-container">
      <form class="auth-form" onsubmit="handleSignIn(event)">
        <label for="signInEmail">Email Address</label>
        <input type="email" id="signInEmail" required />
        <label for="signInPassword">Password</label>
        <input type="password" id="signInPassword" required />
        <button type="submit">Sign In</button>
        <p class="error" id="signInErrorMessage"></p>
        <p>Don't have an account? <a href="/signup">Sign Up</a></p>
      </form>
    </div>
  </main>
  <Footer />
  <script type="module" src="/public/scripts/auth.js"></script>
  <script type="module">
    import { signIn } from '/public/auth.js';

    const handleSignIn = async (event) => {
      event.preventDefault();
      const email = document.getElementById('signInEmail').value;
      const password = document.getElementById('signInPassword').value;
      try {
        const user = await signIn(email, password);
        console.log('Signed in successfully:', user);
        document.getElementById('signInErrorMessage').textContent = '';
        window.location.href = '/';
      } catch (error) {
        document.getElementById('signInErrorMessage').textContent = error.message;
      }
    };

    document.querySelector('form[onsubmit="handleSignIn(event)"]').onsubmit = handleSignIn;
  </script>
</body>
</html>